#!/usr/bin/env pwsh
# Скрипт для компиляции и запуска Java приложения

# Установите путь к вашему проекту
$PROJECT_DIR = "C:\Users\Coldsteeze\Documents\GitHub\ecosystem-simulator\ecosystem-simulator"

# Перейдите в директорию проекта
Set-Location $PROJECT_DIR

# Установите переменную CLASSPATH
$Env:CLASSPATH = "target\classes"

# Создайте директорию для классов, если она не существует
if (-Not (Test-Path $Env:CLASSPATH)) {
    New-Item -ItemType Directory -Path $Env:CLASSPATH
}

# Компиляция Java файлов
Write-Host "Компиляция Java файлов..."
$javaFiles = Get-ChildItem -Recurse -Filter *.java -Path "src" | ForEach-Object { $_.FullName }
javac -d $Env:CLASSPATH $javaFiles

# Проверка на успешную компиляцию
if ($LASTEXITCODE -eq 0) {
    Write-Host "Компиляция прошла успешно."
} else {
    Write-Host "Ошибка компиляции."
    exit 1
}

# Запуск приложения
Write-Host "Запуск приложения..."
java -cp $Env:CLASSPATH korobkin.nikita.Main